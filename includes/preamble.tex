\ProvidesFile{preamble.tex}[2014/09/02 v1.1 -- Syllabus preamble]

% basic typography
\usepackage{fontspec,realscripts}
\defaultfontfeatures{Ligatures=TeX}
\setmainfont[%
  Numbers={Proportional,OldStyle},
  SmallCapsFeatures={RawFeature=+c2sc;+smcp,LetterSpace=1}]{Scala OT}
\newfontfamily\lining[Numbers={Lining}]{Scala OT}
\setsansfont[%
  SmallCapsFeatures={RawFeature=+c2sc;+smcp,LetterSpace=1}]{Scala Sans Pro}
\setmonofont[Scale=MatchLowercase]{Menlo}
\usepackage{sectsty}
\allsectionsfont{\sffamily\scshape}
\frenchspacing
\setlength{\emergencystretch}{3em} % prevent overfull lines

% custom font size and leading
\renewcommand\tiny{\fontsize{6}{9}\selectfont}
\renewcommand\scriptsize{\fontsize{7}{10}\selectfont}
\renewcommand\footnotesize{\fontsize{8}{10}\selectfont}
\renewcommand\small{\fontsize{9}{11}\selectfont}
\renewcommand\normalsize{\fontsize{10}{12}\selectfont}% base size
\renewcommand\large{\fontsize{11}{13}\selectfont}
\renewcommand\Large{\fontsize{12}{14}\selectfont}
\renewcommand\LARGE{\fontsize{16}{18}\selectfont}% "course syllabus \\ semester" benefits from more lead
\renewcommand\huge{\fontsize{20}{22}\selectfont}
\renewcommand\Huge{\fontsize{24}{26}\selectfont}

% layout packages: page, logo, tables
\usepackage[scale={0.6,0.8},
            xetex]{geometry}
\usepackage{graphicx}
\usepackage{array}     % allow insertions of column styling with >{}
\usepackage{booktabs}  % elegant horizontal rules in tables

% custom macros for a session count in the schedule of readings
\newcounter{session}
\newcounter{columns}
\newcounter{spancolumns}
\newcounter{midcolumns}
\newcounter{courseunit}
\newcommand\setcolumncount[2][0]{ % optionally set count to other than 0,
  \setcounter{session}{#1}        % e.g. to -1, or to a standing count
  \setcounter{columns}{#2}
  \setcounter{spancolumns}{#2-1}
  \setcounter{midcolumns}{#2-2}}
\newcommand\sessioncount{\stepcounter{session}\arabic{session}}
\newcommand\sessionskip[1]{\multicolumn{1}{@{}r@{ }}{#1}}
\newcommand\unit[1]{\multicolumn{\thecolumns}{c}{%
  \scshape\stepcounter{courseunit}\roman{courseunit}. #1}}
\newcommand\noclass[1]{\sessionskip{---.}&\multicolumn{\themidcolumns}{@{}l}{\itshape No Class: #1}}
\newcommand\rarr{\Large\char"EA31\hspace*{0.5pt}} % pointer finger w/ reminder tie in Scala OT
\newcommand\reminder[2]{\sessionskip{\rarr}&\multicolumn{\thespancolumns}{@{}l}{#1 \hfill #2}}

% color to match Tyndale's branding
\usepackage[usenames]{xcolor}
% predefined: black, white, red, green, blue, cyan, magenta, yellow
\definecolor{TyndaleURLs}{HTML}{0062A0} % links on tyndale.ca
\definecolor{TyndaleBlue}{cmyk}{1,1,0,.32}
\definecolor{TyndaleGold}{cmyk}{0,.27,1,0}
\definecolor{TyndaleRed}{cmyk}{0,1,.99,.04}
\definecolor{TyndaleBlack}{cmyk}{0,0,0,1}
\definecolor{TyndaleGreen}{cmyk}{.45,0,1,.24}
\definecolor{TyndaleOrange}{cmyk}{0,.79,1,0}
\definecolor{TyndaleAqua}{cmyk}{.47,0,.24,0}
\definecolor{TyndaleYellow}{cmyk}{.03,.03,.35,0}

% metadata (assumes a host of definitions are made in the main file)
\usepackage[setpagesize=false,     % leave this to geometry
            hyperfootnotes=false,  % fragile and distracting
            xetex]{hyperref}
\hypersetup{breaklinks=true,       % allow link text to break across lines
            colorlinks=true,       % colorlinks resets pdfborder to 0 0 0
            urlcolor=TyndaleURLs,  % for external links
            linkcolor=TyndaleRed,  % for normal internal links
            citecolor=TyndaleGold, % for bibliographical citations in text
            pdfauthor={\prof},
            pdftitle={\ccode: \ctitle},
            pdfsubject={Tyndale UC, \csemester},
            pdfcreator={github.com/danieldriver/syllabus}}
\urlstyle{same}                    % don't use monospace font for urls

% custom footlines
\usepackage{fancyhdr}
\pagestyle{fancy} % turn it on
\fancyhf{}        % reset everything
\renewcommand{\headrulewidth}{0pt} % remove header line as well
\lfoot{\sffamily\scshape\footnotesize\ctitle, \csemester}
\rfoot{\sffamily\scshape\footnotesize\prof\quad\thepage}

% language support: polyglossia needs to go last
\usepackage{polyglossia}
\setdefaultlanguage{english}
\setotherlanguage{hebrew}
\newfontfamily\hebrewfont[Script=Hebrew]{SBL BibLit}

% protect positioning of margin table in policy/grades -- needs to come after polyglossia
\usepackage{marginfix}

% gratuitous with custom title page, but useful as a fallback
\title{\ccode: \ctitle}
\author{\professor}
\date{\semester}
